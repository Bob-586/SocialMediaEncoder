function postAjax(e,b,c){var d="string"==typeof b?b:Object.keys(b).map(function(a){return encodeURIComponent(a)+"="+encodeURIComponent(b[a])}).join("&"),a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a.open("POST",e);a.onreadystatechange=function(){3<a.readyState&&200==a.status&&c(a.responseText)};a.setRequestHeader("X-Requested-With","XMLHttpRequest");a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.send(d);return a}
function sleep(e){return new Promise(b=>setTimeout(b,e))}
function post(){if(40>document.getElementById("enc").value.length)throw document.getElementById("msg").innerHTML="Please write more...","not written enough text";document.getElementById("post").disabled=!0;document.getElementById("msg").innerHTML="Posting....";sleep(2500).then(()=>{var e=document.getElementById("enc").value,b=document.getElementById("pwd").value,c=0<b.length;try{var d=do_enc("xor","des",e,b);postAjax("do_post.php",{enc:d,pass:c},function(a){a=JSON.parse(a);if(a.hasOwnProperty("Failed"))document.getElementById("msg").innerHTML=
a.Failed;else if(a.hasOwnProperty("Success")&&a.hasOwnProperty("id")){var b=a.id,c=window.location.href.replace("post.php","").replace("index.php",""),d="";a.hasOwnProperty("ds")&&(d="/"+a.ds);a=a.Success+". Your Link is: "+c+b+d;document.getElementById("msg").innerHTML=a;document.getElementById("post").disabled=!1;document.getElementById("enc").value=""}})}catch(a){"undefined"!=typeof a.message?(console.warn(a.message),alert(a.message)):(console.warn(a),alert(a)),document.getElementById("post").disabled=
!1,document.getElementById("msg").innerHTML=""}})}
function feed_fetch(e,b){postAjax("do_fetch.php",{id:e},function(c){document.getElementById("wait").innerHTML="";c=JSON.parse(c);if(c.hasOwnProperty("Failed")){var d=document.getElementById("feed_update_list"),a=document.createElement("li");a.innerHTML=c.Failed;d.appendChild(a)}else if(!1===c)d=document.getElementById("feed_update_list"),a=document.createElement("li"),a.innerHTML="No Message Found!",d.appendChild(a);else{d="";if(c.hasOwnProperty("has_pwd")&&"Y"===c.has_pwd){var f=document.getElementById("password");
a=document.getElementById("pwd");if("undefined"!=typeof f&&null!=f&&"none"===f.style.display)throw f.style.display="block","Needs password";"undefined"!=typeof a&&null!=a&&(d=a.value)}f="";c.hasOwnProperty("ds")&&""!==b&&(a=c.ds,f="<br><br>Original Message was lost! This may not be the intended message the user wanted to share/post, anymore.",a===b&&(f="<br><br>Message confirmed to match verification code. This is the intended message, user wanted to share/post."));c.hasOwnProperty("cypher")?(c=do_dec(c.cypher,
d).replace(/(?:\r\n|\r|\n)/g,"<br>"),d=document.getElementById("feed_update_list"),a=document.createElement("li"),a.innerHTML=(c+f).trim(),d.appendChild(a),c=document.createElement("hr"),d.appendChild(c),document.getElementById("btn-abuse").style.display="block"):document.getElementById("wait").innerHTML="No Results Found"}})}
function feed_fetchs(e){postAjax("do_fetchs.php",{page:e},function(b){document.getElementById("wait").innerHTML="";b=JSON.parse(b);if(b.hasOwnProperty("Failed")){var c=document.getElementById("feed_update_list"),d=document.createElement("li");d.innerHTML=b.Failed;c.appendChild(d)}else if(!1===b)c=document.getElementById("feed_update_list"),d=document.createElement("li"),d.innerHTML="No more Messages Found!",c.appendChild(d);else for(var a=0;a<b.length;a++)if(b[a].hasOwnProperty("cypher")){var f=do_dec(b[a].cypher,
"").replace(/(?:\r\n|\r|\n)/g,"<br>");c=document.getElementById("feed_update_list");d=document.createElement("li");var e="";b[a].hasOwnProperty("ds")&&(e="/"+b[a].ds);b[a].hasOwnProperty("id")&&(e="<br><br> ** The Shared Link for this message is &nbsp; &nbsp; "+window.location.href.replace("index.php","")+b[a].id+e,f+="<button onclick='btn_report(\""+b[a].id+"\");'>Report Abuse</button>",f+=e);d.innerHTML=f.trim();c.appendChild(d);d=document.createElement("hr");c.appendChild(d);document.getElementById("pages").style.display=
"block"}})};