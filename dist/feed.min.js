function postAjax(e,d,b){var c="string"==typeof d?d:Object.keys(d).map(function(a){return encodeURIComponent(a)+"="+encodeURIComponent(d[a])}).join("&"),a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a.open("POST",e);a.onreadystatechange=function(){3<a.readyState&&200==a.status&&b(a.responseText)};a.setRequestHeader("X-Requested-With","XMLHttpRequest");a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.send(c);return a}
function sleep(e){return new Promise(d=>setTimeout(d,e))}
function post(){if(40>document.getElementById("enc").value.length)throw document.getElementById("msg").innerHTML="Please write more...","not written enough text";document.getElementById("post").disabled=!0;document.getElementById("msg").innerHTML="Posting....";sleep(2500).then(()=>{var e=document.getElementById("enc").value,d=document.getElementById("pwd").value,b=0<d.length;try{var c=do_enc("xor","des",e,d);postAjax("do_post.php",{enc:c,pass:b},function(a){a=JSON.parse(a);if(a.hasOwnProperty("Failed"))document.getElementById("msg").innerHTML=
a.Failed;else if(a.hasOwnProperty("Success")&&a.hasOwnProperty("id")){var b=a.id,d=window.location.href.replace("post.php","").replace("index.php",""),c="";a.hasOwnProperty("ds")&&(c="/"+a.ds);a=a.Success+". Your Link is: "+d+b+c;document.getElementById("msg").innerHTML=a;document.getElementById("post").disabled=!1;document.getElementById("enc").value=""}})}catch(a){"undefined"!=typeof a.message?(console.warn(a.message),alert(a.message)):(console.warn(a),alert(a)),document.getElementById("post").disabled=
!1,document.getElementById("msg").innerHTML=""}})}
function feed_fetch(e,d){postAjax("do_fetch.php",{id:e},function(b){document.getElementById("wait").innerHTML="";b=JSON.parse(b);if(b.hasOwnProperty("Failed")){var c=document.getElementById("feed_update_list"),a=document.createElement("li");a.innerHTML=b.Failed;c.appendChild(a)}else if(b.hasOwnProperty("approved")&&"N"===b.approved){c=document.getElementById("feed_update_list");a=document.createElement("li");var e="";if(b.hasOwnProperty("flags")&&3<b.flags.length){b=JSON.parse(b.flags);for(var f in b)e+=
" - ("+b[f]+") Flagged as "+f+" abuse."}a.innerHTML="Sorry, that message was BANNED! "+e;c.appendChild(a)}else if(!1===b)c=document.getElementById("feed_update_list"),a=document.createElement("li"),a.innerHTML="No Message Found!",c.appendChild(a);else{c="";if(b.hasOwnProperty("has_pwd")&&"Y"===b.has_pwd){a=document.getElementById("password");f=document.getElementById("pwd");if("undefined"!=typeof a&&null!=a&&"none"===a.style.display)throw a.style.display="block","Needs password";"undefined"!=typeof f&&
null!=f&&(c=f.value)}f="";b.hasOwnProperty("ds")&&""!==d&&(a=b.ds,f="<br><br>Original Message was lost! This may not be the intended message the user wanted to share/post, anymore.",a===d&&(f="<br><br>Message confirmed to match verification code. This is the intended message, user wanted to share/post."));b.hasOwnProperty("cypher")?(b=do_dec(b.cypher,c).replace(/(?:\r\n|\r|\n)/g,"<br>"),c=document.getElementById("feed_update_list"),a=document.createElement("li"),a.innerHTML=(b+f).trim(),c.appendChild(a),
b=document.createElement("hr"),c.appendChild(b),document.getElementById("btn-abuse").style.display="block"):document.getElementById("wait").innerHTML="No Results Found"}})}
function feed_fetchs(e){postAjax("do_fetchs.php",{page:e},function(d){document.getElementById("wait").innerHTML="";d=JSON.parse(d);if(d.hasOwnProperty("Failed")){var b=document.getElementById("feed_update_list"),c=document.createElement("li");c.innerHTML=d.Failed;b.appendChild(c)}else if(!1===d)b=document.getElementById("feed_update_list"),c=document.createElement("li"),c.innerHTML="No more Messages Found!",b.appendChild(c);else for(var a=0;a<d.length;a++)if(d[a].hasOwnProperty("cypher")){var e=do_dec(d[a].cypher,
"").replace(/(?:\r\n|\r|\n)/g,"<br>");b=document.getElementById("feed_update_list");c=document.createElement("li");var f="";d[a].hasOwnProperty("ds")&&(f="/"+d[a].ds);if(d[a].hasOwnProperty("id")){var g=window.location.href.replace("index.php","");e+="<br><br>"+("<button onclick='btn_report(\""+d[a].id+"\");'>Report Abuse</button>")+" ** The Shared Link for this message is &nbsp; &nbsp; "+g+d[a].id+f}c.innerHTML=e.trim();b.appendChild(c);c=document.createElement("hr");b.appendChild(c);document.getElementById("pages").style.display=
"block"}})};