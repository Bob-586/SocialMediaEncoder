function postAjax(f,c,b){var d="string"==typeof c?c:Object.keys(c).map(function(a){return encodeURIComponent(a)+"="+encodeURIComponent(c[a])}).join("&"),a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a.open("POST",f);a.onreadystatechange=function(){3<a.readyState&&200==a.status&&b(a.responseText)};a.setRequestHeader("X-Requested-With","XMLHttpRequest");a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.send(d);return a}
function sleep(f){return new Promise(c=>setTimeout(c,f))}
function post(){if(40>document.getElementById("enc").value.length)throw document.getElementById("msg").innerHTML="Please write more...","not written enough text";document.getElementById("post").disabled=!0;document.getElementById("msg").innerHTML="Posting....";sleep(2500).then(()=>{var f=document.getElementById("enc").value,c=document.getElementById("pwd").value,b=0<c.length;try{var d=do_enc("xor","des",f,c),a=get_styles(),g=document.getElementById("tags").value;postAjax("do_post.php",{enc:d,pass:b,
style:a,tags:g},function(a){a=JSON.parse(a);if(a.hasOwnProperty("Failed"))document.getElementById("msg").innerHTML=a.Failed;else if(a.hasOwnProperty("Success")&&a.hasOwnProperty("id")){var b=a.id,c=window.location.href.replace("post.php","").replace("index.php",""),d="";a.hasOwnProperty("ds")&&(d="/"+a.ds);a=a.Success+". Your Link is: "+c+b+d;document.getElementById("msg").innerHTML=a;document.getElementById("post").disabled=!1;document.getElementById("enc").value=""}})}catch(e){"undefined"!=typeof e.message?
(console.warn(e.message),alert(e.message)):(console.warn(e),alert(e)),document.getElementById("post").disabled=!1,document.getElementById("msg").innerHTML=""}})}
function feed_fetch(f,c){postAjax("do_fetch.php",{id:f},function(b){document.getElementById("wait").innerHTML="";b=JSON.parse(b);if(b.hasOwnProperty("Failed")){var d=document.getElementById("feed_update_list"),a=document.createElement("li");a.innerHTML=b.Failed;d.appendChild(a)}else if(b.hasOwnProperty("approved")&&"N"===b.approved){d=document.getElementById("feed_update_list");a=document.createElement("li");var g="";if(b.hasOwnProperty("flags")&&3<b.flags.length){b=JSON.parse(b.flags);for(var e in b)g+=
" - ("+b[e]+") Flagged as "+e+" abuse."}a.innerHTML="Sorry, that message was BANNED! "+g;d.appendChild(a)}else if(!1===b)d=document.getElementById("feed_update_list"),a=document.createElement("li"),a.innerHTML="No Message Found!",d.appendChild(a);else{d="";if(b.hasOwnProperty("has_pwd")&&"Y"===b.has_pwd){a=document.getElementById("password");e=document.getElementById("pwd");if("undefined"!=typeof a&&null!=a&&"none"===a.style.display)throw a.style.display="block","Needs password";"undefined"!=typeof e&&
null!=e&&(d=e.value)}e="";b.hasOwnProperty("ds")&&""!==c&&(a=b.ds,e="<br><br>Original Message was lost! This may not be the intended message the user wanted to share/post, anymore.",a===c&&(e="<br><br>Message confirmed to match verification code. This is the intended message, user wanted to share/post."));g="";b.hasOwnProperty("style")&&(g=b.style);b.hasOwnProperty("cypher")?(b=do_dec(b.cypher,d).replace(/(?:\r\n|\r|\n)/g,"<br>"),d=document.getElementById("feed_update_list"),a=document.createElement("li"),
a.style=g,a.innerHTML=(b+e).trim(),d.appendChild(a),b=document.createElement("hr"),d.appendChild(b),document.getElementById("btn-abuse").style.display="block"):document.getElementById("wait").innerHTML="No Results Found"}})}
function feed_fetchs(f){postAjax("do_fetchs.php",{page:f},function(c){document.getElementById("wait").innerHTML="";c=JSON.parse(c);if(c.hasOwnProperty("Failed")){var b=document.getElementById("feed_update_list"),d=document.createElement("li");d.innerHTML=c.Failed;b.appendChild(d)}else if(!1===c)b=document.getElementById("feed_update_list"),d=document.createElement("li"),d.innerHTML="No more Messages Found!",b.appendChild(d);else for(var a=0;a<c.length;a++){var g="";c[a].hasOwnProperty("style")&&(g=
c[a].style);if(c[a].hasOwnProperty("cypher")){var e=do_dec(c[a].cypher,"").replace(/(?:\r\n|\r|\n)/g,"<br>");b=document.getElementById("feed_update_list");d=document.createElement("li");var f="";c[a].hasOwnProperty("ds")&&(f="/"+c[a].ds);if(c[a].hasOwnProperty("id")){var h=window.location.href.replace("index.php","");e+="<br><br>"+("<button onclick='btn_report(\""+c[a].id+"\");'>Report Abuse</button>")+" ** The Shared Link for this message is &nbsp; &nbsp; "+h+c[a].id+f}d.style=g;d.innerHTML=e.trim();
b.appendChild(d);d=document.createElement("hr");b.appendChild(d);document.getElementById("pages").style.display="block"}}})};