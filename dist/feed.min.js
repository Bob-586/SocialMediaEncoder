function postAjax(g,f,c){var b="string"==typeof f?f:Object.keys(f).map(function(a){return encodeURIComponent(a)+"="+encodeURIComponent(f[a])}).join("&"),a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a.open("POST",g);a.onreadystatechange=function(){3<a.readyState&&200==a.status&&c(a.responseText)};a.setRequestHeader("X-Requested-With","XMLHttpRequest");a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.send(b);return a}
function sleep(g){return new Promise(f=>setTimeout(f,g))}
function post(){if(40>document.getElementById("enc").value.length)throw document.getElementById("msg").innerHTML="Please write more...","not written enough text";document.getElementById("post").disabled=!0;document.getElementById("msg").innerHTML="Posting....";sleep(2500).then(()=>{var g=document.getElementById("enc").value,f=document.getElementById("pwd").value,c=0<f.length;try{var b=do_enc("xor","des",g,f),a=get_styles(),e=document.getElementById("tags").value;postAjax("do_post.php",{enc:b,pass:c,
style:a,tags:e},function(a){a=JSON.parse(a);if(a.hasOwnProperty("Failed"))document.getElementById("msg").innerHTML=a.Failed;else if(a.hasOwnProperty("Success")&&a.hasOwnProperty("id")){var b=a.id,c=window.location.href.replace("post.php","").replace("index.php",""),d="";a.hasOwnProperty("ds")&&(d="/"+a.ds);a=a.Success+". Your Link is: "+c+b+d;document.getElementById("msg").innerHTML=a;document.getElementById("post").disabled=!1;document.getElementById("enc").value=""}})}catch(d){"undefined"!=typeof d.message?
(console.warn(d.message),alert(d.message)):(console.warn(d),alert(d)),document.getElementById("post").disabled=!1,document.getElementById("msg").innerHTML=""}})}
function feed_fetch(g,f){postAjax("do_fetch.php",{id:g},function(c){document.getElementById("wait").innerHTML="";var b=JSON.parse(c);if(b.hasOwnProperty("Failed")){c=document.getElementById("feed_update_list");var a=document.createElement("li");a.innerHTML=b.Failed;c.appendChild(a)}else if(b.hasOwnProperty("approved")&&"N"===b.approved){c=document.getElementById("feed_update_list");a=document.createElement("li");var e="";if(b.hasOwnProperty("flags")&&3<b.flags.length){b=JSON.parse(b.flags);for(var d in b)e+=
" - ("+b[d]+") Flagged as "+d+" abuse."}a.innerHTML="Sorry, that message was BANNED! "+e;c.appendChild(a)}else if(!1===b)c=document.getElementById("feed_update_list"),a=document.createElement("li"),a.innerHTML="No Message Found!",c.appendChild(a);else{c="";if(b.hasOwnProperty("has_pwd")&&"Y"===b.has_pwd){a=document.getElementById("password");d=document.getElementById("pwd");if("undefined"!=typeof a&&null!=a&&"none"===a.style.display)throw a.style.display="block","Needs password";"undefined"!=typeof d&&
null!=d&&(c=d.value)}d="";b.hasOwnProperty("ds")&&""!==f&&(a=b.ds,d="Original Message was lost! This may not be the intended message the user wanted to share/post, anymore.",a===f&&(d="Message confirmed to match verification code. This is the intended message, user wanted to share/post."));e="";b.hasOwnProperty("style")&&(e=b.style);if(b.hasOwnProperty("cypher")){var g=do_dec(b.cypher,c).replace(/(?:\r\n|\r|\n)/g,"<br>");c=document.getElementById("feed_update_list");a=document.createElement("li");
a.style=e;a.innerHTML=g.trim();c.appendChild(a);""!==d&&(a=document.createElement("div"),a.innerHTML=d,c.appendChild(a));a="";b.hasOwnProperty("ds")&&(a="/"+b.ds);b.hasOwnProperty("id")&&(b="<br>"+("<button onclick='btn_report(\""+b.id+"\");'>Report Abuse</button>")+" ** The Shared Link for this message is &nbsp; &nbsp; "+mysite+b.id+a,a=document.createElement("span"),a.innerHTML=b,c.appendChild(a));b=document.createElement("hr");c.appendChild(b)}else document.getElementById("wait").innerHTML="No Results Found"}})}
function feed_fetchs(g,f){postAjax("do_fetchs.php",{page:g,limit:f},function(c){document.getElementById("wait").innerHTML="";c=JSON.parse(c);if(c.hasOwnProperty("Failed")){var b=document.getElementById("feed_update_list"),a=document.createElement("li");a.innerHTML=c.Failed;b.appendChild(a)}else if(!1===c)b=document.getElementById("feed_update_list"),a=document.createElement("li"),a.innerHTML="No more Messages Found!",b.appendChild(a);else for(var e=0;e<c.length;e++){var d="";c[e].hasOwnProperty("style")&&
(d=c[e].style);if(c[e].hasOwnProperty("cypher")){var f=do_dec(c[e].cypher,"").replace(/(?:\r\n|\r|\n)/g,"<br>");b=document.getElementById("feed_update_list");a=document.createElement("li");var g="";c[e].hasOwnProperty("ds")&&(g="/"+c[e].ds);a.style=d;a.innerHTML=f.trim();b.appendChild(a);c[e].hasOwnProperty("id")&&(a="<br>"+("<button onclick='btn_report(\""+c[e].id+"\");'>Report Abuse</button>")+" ** The Shared Link for this message is &nbsp; &nbsp; "+mysite+c[e].id+g,d=document.createElement("span"),
d.innerHTML=a,b.appendChild(d));a=document.createElement("hr");b.appendChild(a)}}})};