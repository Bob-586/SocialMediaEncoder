function postAjax(f,d,b){var c="string"==typeof d?d:Object.keys(d).map(function(a){return encodeURIComponent(a)+"="+encodeURIComponent(d[a])}).join("&"),a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a.open("POST",f);a.onreadystatechange=function(){3<a.readyState&&200==a.status&&b(a.responseText)};a.setRequestHeader("X-Requested-With","XMLHttpRequest");a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.send(c);return a}
function sleep(f){return new Promise(d=>setTimeout(d,f))}
function post(){if(40>document.getElementById("enc").value.length)throw document.getElementById("msg").innerHTML="Please write more...","not written enough text";document.getElementById("post").disabled=!0;document.getElementById("msg").innerHTML="Posting....";sleep(2500).then(()=>{var f=document.getElementById("enc").value,d=document.getElementById("pwd").value,b=0<d.length;try{var c=do_enc("xor","des",f,d),a=get_styles(),g=document.getElementById("tags").value;postAjax("do_post.php",{enc:c,pass:b,
style:a,tags:g},function(a){a=JSON.parse(a);if(a.hasOwnProperty("Failed"))document.getElementById("msg").innerHTML=a.Failed;else if(a.hasOwnProperty("Success")&&a.hasOwnProperty("id")){var b=a.id,c=window.location.href.replace("post.php","").replace("index.php",""),d="";a.hasOwnProperty("ds")&&(d="/"+a.ds);a=a.Success+". Your Link is: "+c+b+d;document.getElementById("msg").innerHTML=a;document.getElementById("post").disabled=!1;document.getElementById("enc").value=""}})}catch(e){"undefined"!=typeof e.message?
(console.warn(e.message),alert(e.message)):(console.warn(e),alert(e)),document.getElementById("post").disabled=!1,document.getElementById("msg").innerHTML=""}})}
function feed_fetch(f,d){postAjax("do_fetch.php",{id:f},function(b){document.getElementById("wait").innerHTML="";b=JSON.parse(b);if(b.hasOwnProperty("Failed")){var c=document.getElementById("feed_update_list"),a=document.createElement("li");a.innerHTML=b.Failed;c.appendChild(a)}else if(b.hasOwnProperty("approved")&&"N"===b.approved){c=document.getElementById("feed_update_list");a=document.createElement("li");var g="";if(b.hasOwnProperty("flags")&&3<b.flags.length){b=JSON.parse(b.flags);for(var e in b)g+=
" - ("+b[e]+") Flagged as "+e+" abuse."}a.innerHTML="Sorry, that message was BANNED! "+g;c.appendChild(a)}else if(!1===b)c=document.getElementById("feed_update_list"),a=document.createElement("li"),a.innerHTML="No Message Found!",c.appendChild(a);else{c="";if(b.hasOwnProperty("has_pwd")&&"Y"===b.has_pwd){a=document.getElementById("password");e=document.getElementById("pwd");if("undefined"!=typeof a&&null!=a&&"none"===a.style.display)throw a.style.display="block","Needs password";"undefined"!=typeof e&&
null!=e&&(c=e.value)}e="";b.hasOwnProperty("ds")&&""!==d&&(a=b.ds,e="<br><br>Original Message was lost! This may not be the intended message the user wanted to share/post, anymore.",a===d&&(e="<br><br>Message confirmed to match verification code. This is the intended message, user wanted to share/post."));g="";b.hasOwnProperty("style")&&(g=b.style);if(b.hasOwnProperty("cypher")){var f=do_dec(b.cypher,c).replace(/(?:\r\n|\r|\n)/g,"<br>");c=document.getElementById("feed_update_list");a=document.createElement("li");
a.style=g;a.innerHTML=(f+e).trim();c.appendChild(a);b.hasOwnProperty("ds");b.hasOwnProperty("id")&&(b="<br>"+("<button onclick='btn_report(\""+b.id+"\");'>Report Abuse</button>")+" ** The Shared Link for this message is &nbsp; &nbsp; "+window.location.href,a=document.createElement("span"),a.innerHTML=b,c.appendChild(a));b=document.createElement("hr");c.appendChild(b)}else document.getElementById("wait").innerHTML="No Results Found"}})}
function feed_fetchs(f){postAjax("do_fetchs.php",{page:f},function(d){document.getElementById("wait").innerHTML="";d=JSON.parse(d);if(d.hasOwnProperty("Failed")){var b=document.getElementById("feed_update_list"),c=document.createElement("li");c.innerHTML=d.Failed;b.appendChild(c)}else if(!1===d)b=document.getElementById("feed_update_list"),c=document.createElement("li"),c.innerHTML="No more Messages Found!",b.appendChild(c);else for(var a=0;a<d.length;a++){var f="";d[a].hasOwnProperty("style")&&(f=
d[a].style);if(d[a].hasOwnProperty("cypher")){var e=do_dec(d[a].cypher,"").replace(/(?:\r\n|\r|\n)/g,"<br>");b=document.getElementById("feed_update_list");c=document.createElement("li");var h="";d[a].hasOwnProperty("ds")&&(h="/"+d[a].ds);c.style=f;c.innerHTML=e.trim();b.appendChild(c);d[a].hasOwnProperty("id")&&(c=window.location.href.replace("index.php",""),h="<br>"+("<button onclick='btn_report(\""+d[a].id+"\");'>Report Abuse</button>")+" ** The Shared Link for this message is &nbsp; &nbsp; "+c+
d[a].id+h,c=document.createElement("span"),c.innerHTML=h,b.appendChild(c));h=document.createElement("hr");b.appendChild(h);document.getElementById("pages").style.display="block"}}})};